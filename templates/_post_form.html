<div class="mb-6">
    <label for="title" class="block text-lg font-medium text-gray-700 mb-2">Заголовок</label>
    <input type="text" name="title" id="title" value="{{ post.title if post else '' }}" required 
           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500">
</div>

<div class="mb-6">
    <label for="content" class="block text-lg font-medium text-gray-700 mb-2">Содержание (Markdown)</label>
    <textarea name="content" id="content" rows="20" required 
              class="w-full px-4 py-3 border border-gray-300 rounded-lg">{{ post.content if post else '' }}</textarea>
</div>

<div class="mb-6">
    <label for="image_urls" class="block text-lg font-medium text-gray-700 mb-2">Ссылки на изображения (через запятую)</label>
    <input type="text" name="image_urls" id="image_urls" value="{{ current_urls if current_urls else '' }}" 
           placeholder="https://example.com/img1.jpg, https://example.com/img2.jpg"
           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500">
    <p class="text-sm text-gray-500 mt-2">Первая ссылка — главная картинка</p>
</div>

<div class="mb-6 flex flex-wrap items-center gap-8">
    <label class="flex items-center">
        <input type="checkbox" name="is_pinned" {% if post and post.is_pinned %}checked{% endif %} class="mr-2">
        <span class="text-lg">Закрепить новость</span>
    </label>

    <div>
        <label for="category" class="block text-lg font-medium text-gray-700 mb-2">Категория</label>
        <select name="category" id="category" class="px-4 py-3 border border-gray-300 rounded-lg">
            <option value="news" {% if not post or post.category == 'news' %}selected{% endif %}>Новости</option>
            <option value="history" {% if post and post.category == 'history' %}selected{% endif %}>История</option>
            <option value="finance" {% if post and post.category == 'finance' %}selected{% endif %}>Финансы</option>
            <option value="sport" {% if post and post.category == 'sport' %}selected{% endif %}>Спорт</option>
        </select>
    </div>
</div>

<!-- EasyMDE CDN + инициализация -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/easymde@2.18.0/dist/easymde.min.css">
<script src="https://cdn.jsdelivr.net/npm/easymde@2.18.0/dist/easymde.min.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const textarea = document.getElementById('content');
        if (textarea) {
            const easymde = new EasyMDE({
                element: textarea,
                spellChecker: false,
                forceSync: true,
                autosave: {
                    enabled: true,
                    uniqueId: "admin-post-content-" + Date.now(),
                    delay: 2000
                },
                toolbar: ["bold", "italic", "heading", "|", "quote", "unordered-list", "ordered-list", "|", "link", "image", "|", "preview", "side-by-side", "fullscreen", "|", "guide"]
            });
        }
    });
</script>